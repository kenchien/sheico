<?xml version="1.0" encoding="utf-8"?>
<configuration>
   <configSections>
      <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" />
   </configSections>
   <connectionStrings>
      <add name="SmartIDAConnection" connectionString="DATA SOURCE=localhost:1521/ORCL;USER ID=SMARTIDA;PASSWORD=oracle;" />
   </connectionStrings>
   <appSettings>
      <!--no use-->
      <add key="TimeInterval" value="60" />
      <!--The license context used-->
      <add key="EPPlus:ExcelPackage.LicenseContext" value="NonCommercial" />
      <!--範本檔的完整路徑與檔名(必須完整路徑,不然放到正式機會總是去抓c:\windows\system32\xxx) -->
      <add key="TemplatePathName" value="Template\CDC_系統指標_範本.xlsx" />
      <!--匯出excel檔案的路徑(不需檔名)-->
      <add key="OutputPath" value="c:\ken" />
      <!--是否要發信,1=發信,0=不發-->
      <add key="NeedSendMail" value="0" />
      <!--發信給誰,多人就逗號分開-->
      <add key="MailTo" value="andisand@gmail.com" />
      <!--log4net如果寫入資料庫有問題,可以打開這個查看錯誤 -->
      <!--<add key="log4net.Internal.Debug" value="true" />  -->
      <!--(額外發信)問題反映清單,是否發送,1=發信,0=不發-->
      <add key="NeedFeedback" value="0" />
      <!--(額外發信)問題反映清單,發信給誰,多人就逗號分開-->
      <add key="FeedbackMailTo" value="andisand@gmail.com" />
      <add key="ClientSettingsProvider.ServiceUri" value="" />


      <!--偵測系統運作情況,檢查的網址(參數不開放編輯)-->
      <add key="CheckUrl" value="http://localhost:51922/api/PublishAnnouncement" />
      <!--偵測系統運作情況,有發生異常就發信給下面人員,多人就逗號分開-->
      <add key="AlarmMailTo" value="kenchien@xsolutions.com.tw,andisand@gmail.com" />
   </appSettings>
   <log4net>
      <appender name="AdoNetAppender_Oracle" type="log4net.Appender.AdoNetAppender">
         <!--log4net 要寫到oracle必須用內建元件Oracle.ManagedDataAccess,connectionType設定如下 -->
         <!-- <connectionType value="Oracle.ManagedDataAccess.Client.OracleConnection,Oracle.ManagedDataAccess, Version=4.121.1.0,Culture=neutral, PublicKeyToken=89b483f429c47342" />
         Oracle.ManagedDataAccess.Client.OracleConnection,Oracle.ManagedDataAccess, Version=4.121.1.0,Culture=neutral, PublicKeyToken=89b483f429c47342
         
         <connectionString value="data source = localhost:1521/ORCL;USER ID=SMARTIDA;PASSWORD=oracle;" />
-->
         <commandText value="INSERT INTO Log_job (job_name,Datetime,Thread,Log_Level,Logger,Message) VALUES ('MaintainReport', :log_date, :thread, :log_level, :logger, :message)" />
         <bufferSize value="0" />
         <parameter>
            <parameterName value=":log_date" />
            <dbType value="DateTime" />
            <layout type="log4net.Layout.RawTimeStampLayout" />
         </parameter>
         <parameter>
            <parameterName value=":thread" />
            <dbType value="String" />
            <size value="255" />
            <layout type="log4net.Layout.PatternLayout">
               <conversionPattern value="%thread" />
            </layout>
         </parameter>
         <parameter>
            <parameterName value=":log_level" />
            <dbType value="String" />
            <size value="50" />
            <layout type="log4net.Layout.PatternLayout">
               <conversionPattern value="%level" />
            </layout>
         </parameter>
         <parameter>
            <parameterName value=":logger" />
            <dbType value="String" />
            <size value="255" />
            <layout type="log4net.Layout.PatternLayout">
               <conversionPattern value="%logger" />
            </layout>
         </parameter>
         <parameter>
            <parameterName value=":message" />
            <dbType value="String" />
            <size value="4000" />
            <layout type="log4net.Layout.PatternLayout">
               <conversionPattern value="%message" />
            </layout>
         </parameter>
      </appender>
      <appender name="ConsoleAppender" type="log4net.Appender.ConsoleAppender">
         <layout type="log4net.Layout.PatternLayout">
            <conversionPattern value="%date %-5level: %message%newline" />
         </layout>
      </appender>
      <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
         <file value="../Logs/MaintainReport/MaintainReport" />　
         <!--存放log檔案的路徑--><staticLogFileName value="false" /><appendToFile value="true" /><rollingStyle value="Date" /><datePattern value="_yyyyMMdd.lo\g" />　
         <!--log檔案加上日期--><layout type="log4net.Layout.PatternLayout">
            <conversionPattern value="%date %-5level: %message%newline" />
         </layout>
      </appender>
      <root>
         <level value="INFO" />
         <!-- If the following line is not included the log file 
      will not be created even if log4net is configured with this file. -->
         <appender-ref ref="AdoNetAppender_Oracle" />
         <appender-ref ref="RollingFileAppender" />
         <appender-ref ref="ConsoleAppender" />
      </root>
   </log4net>
   <startup>
      <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.7.2" />
   </startup>
   <runtime>
      <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
         <dependentAssembly>
            <assemblyIdentity name="System.Runtime.CompilerServices.Unsafe" publicKeyToken="b03f5f7f11d50a3a" culture="neutral" />
            <bindingRedirect oldVersion="0.0.0.0-5.0.0.0" newVersion="5.0.0.0" />
         </dependentAssembly>
         <dependentAssembly>
            <assemblyIdentity name="System.Text.Json" publicKeyToken="cc7b13ffcd2ddd51" culture="neutral" />
            <bindingRedirect oldVersion="0.0.0.0-5.0.0.2" newVersion="5.0.0.2" />
         </dependentAssembly>
      </assemblyBinding>
   </runtime>
   <system.web>
      <membership defaultProvider="ClientAuthenticationMembershipProvider">
         <providers>
            <add name="ClientAuthenticationMembershipProvider" type="System.Web.ClientServices.Providers.ClientFormsAuthenticationMembershipProvider, System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" serviceUri="" />
         </providers>
      </membership>
      <roleManager defaultProvider="ClientRoleProvider" enabled="true">
         <providers>
            <add name="ClientRoleProvider" type="System.Web.ClientServices.Providers.ClientRoleProvider, System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" serviceUri="" cacheTimeout="86400" />
         </providers>
      </roleManager>
   </system.web>
</configuration>